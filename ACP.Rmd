---
title: "ACP"
author: "moi"
date: "2025-04-03"
output: html_document
---

## ACP : Analyse en Composantes Principales

```{r, echo=FALSE,warning=FALSE,echo=False}

# Copier le dataset nettoy√©
clean_data <- cleaned_data

# Assigner les noms d'entreprises aux rownames et supprimer la colonne Name
rownames(clean_data) <- clean_data$Name
clean_data$Name <- NULL

# On identifie toutes les colonnes quantitatives pour l'ACP
quantitative_columns <- c("marketCap", "previousClose", "trailingPE", "forwardPE", 
                          "priceToBook", "beta", "profitMargins", "enterpriseToRevenue", 
                          "enterpriseToEbitda", "totalRevenue", "revenuePerShare", 
                          "revenueGrowth", "grossMargins", "ebitdaMargins", "operatingMargins", 
                          "returnOnAssets", "returnOnEquity", "debtToEquity", "currentRatio", 
                          "quickRatio", "totalCash", "totalDebt", "bookValue", 
                          "fiveYearAvgDividendYield", "payoutRatio", 
                          "trailingAnnualDividendYield", "trailingAnnualDividendRate", 
                          "totalEsg", "environmentScore", "socialScore", "governanceScore")

# S√©lection des variables quantitatives + les variables qualitatives pour habillage
data_perf <- clean_data[, c(quantitative_columns, "sector", "Index")]

# Effectuer l'ACP avec variables qualitatives en quali.sup
res_pca <- PCA(data_perf, graph = TRUE, scale.unit = TRUE, ncp = 5, quali.sup = c((length(quantitative_columns) + 1), (length(quantitative_columns) + 2)))

# Afficher les valeurs propres
print(res_pca$eig)
```

En faisant une ACP sur toutes nos donn√©es quantitatives, on obtient 31 axes principaux. Avec les 15 premiers on atteint 80% de variance expliqu√©e. 
Observations :

Si l'on se concentre sur les 5 premiers axes, on atteint 40% de variance expliqu√©e de la f√ßcons suivante: 
pour chaque axe les variables les plus contributrices
- Axe 1 : priceToBook, enterpriseToRevenue, enterpriseToEbitda
- Axe 2 : totalRevenue, totalCash, grossMargins, ebitdaMargins
- Axe 3 : totalEsg, socialScore, ebitdaMargins
- Axe 4 : currentRatio, quickRatio
- Axe 5 : trailingAnnualDividendYield, trailingAnnualDividendRate

```{r , echo=FALSE}
# Contributions des variables
print(res_pca$var$contrib)
```

üìä Axe 1 (Dim.1) Variables dominantes :

priceToBook, enterpriseToRevenue, enterpriseToEbitda (‚âà 98 %) Interpr√©tation : Axe li√© √† la valorisation (ratios financiers).

üìä Axe 2 (Dim.2) Variables dominantes :

totalRevenue (48 %) totalCash (55 %) grossMargins, ebitdaMargins, governanceScore Interpr√©tation : Axe de solidit√© financi√®re et rentabilit√©.

üìä Axe 3 (Dim.3) Variables dominantes :

totalEsg, socialScore, ebitdaMargins Interpr√©tation : Axe ESG et efficacit√© op√©rationnelle.

üìä Axe 4 (Dim.4) Variables dominantes :

currentRatio & quickRatio (\> 63 %) Interpr√©tation : Axe des liquidit√©s (sant√© √† court terme).

üìä Axe 5 (Dim.5) Variables dominantes :

trailingAnnualDividendYield & trailingAnnualDividendRate (\> 97 %) Interpr√©tation : Axe purement li√© au dividende.

4Ô∏è‚É£ Graphiques de l'ACP Graphique individus (habillage par Index)

```{r}
plot(res_pca, habillage = (length(quantitative_columns) + 2), select = "cos2 0.8", choix = "ind")
```

‚úÖ Conclusion Cette ACP permet de bien visualiser :

L‚Äôopposition entre valorisation, marges et politique de dividende. L‚Äôimpact de l‚ÄôESG dans la structure multidimensionnelle. La r√©partition h√©t√©rog√®ne des entreprises selon leur secteur et leur Index. Ce jeu de donn√©es est id√©al pour une analyse multidimensionnelle incluant des m√©thodes comme l‚ÄôACP (Analyse en Composantes Principales), la r√©gression lin√©aire et l‚ÄôANOVA.

## 2. Importation et pr√©traitement des donn√©es

Voir annex pour plus de d√©tails sur les variables du jeu de donn√©es et le code utilis√©e.

```{r, echo=FALSE}
#ACP sur l'esg
data_esg <- cleaned_data[, c("totalEsg", "environmentScore", "socialScore", "governanceScore","esgPerformance","sector")]

res_pca_esg <- PCA(data_esg, graph = T,scale.unit = TRUE, ncp = 5, quali.sup = c(5,6))
res_pca_esg$eig
plot(res_pca_esg, habillage = 5, select = "cos2 0.8",choix = c("ind"))
plot(res_pca_esg, habillage = 6, select = "cos2 0.95",choix = c("ind"))

```