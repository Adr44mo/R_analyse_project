---
title: "ACP"
author: "moi"
date: "2025-04-03"
output: html_document
---

## ACP : Analyse en Composantes Principales

```{r, echo=FALSE,warning=FALSE}

# Copier le dataset nettoyé
clean_data <- cleaned_data

# Assigner les noms d'entreprises aux rownames et supprimer la colonne Name
rownames(clean_data) <- clean_data$Name
clean_data$Name <- NULL

# On identifie toutes les colonnes quantitatives pour l'ACP
quantitative_columns <- c("marketCap", "previousClose", "trailingPE", "forwardPE", 
                          "priceToBook", "beta", "profitMargins", "enterpriseToRevenue", 
                          "enterpriseToEbitda", "totalRevenue", "revenuePerShare", 
                          "revenueGrowth", "grossMargins", "ebitdaMargins", "operatingMargins", 
                          "returnOnAssets", "returnOnEquity", "debtToEquity", "currentRatio", 
                          "quickRatio", "totalCash", "totalDebt", "bookValue", 
                          "fiveYearAvgDividendYield", "payoutRatio", 
                          "trailingAnnualDividendYield", "trailingAnnualDividendRate", 
                          "totalEsg", "environmentScore", "socialScore", "governanceScore")

# Sélection des variables quantitatives + les variables qualitatives pour habillage
data_perf <- clean_data[, c(quantitative_columns, "sector", "Index")]

# Effectuer l'ACP avec variables qualitatives en quali.sup
res_pca <- PCA(data_perf, graph = TRUE, scale.unit = TRUE, ncp = 5, quali.sup = c((length(quantitative_columns) + 1), (length(quantitative_columns) + 2)))

# Afficher les valeurs propres
print(res_pca$eig)

# Contributions des variables
print(res_pca$var$contrib)

plot(res_pca, habillage = (length(quantitative_columns) + 2), select = "cos2 0.8", choix = "ind")

```

En appliquant une **Analyse en Composantes Principales** (ACP) sur l’ensemble de nos données quantitatives, nous obtenons **31 axes** principaux. Parmi eux, les 15 premiers axes permettent d'expliquer 80 % de la variance totale.

**Observations**
Si nous nous concentrons sur les 5 premiers axes, ils expliquent à eux seuls 40 % de la variance, répartie de la manière suivante :

- Axe 1 : *priceToBook, enterpriseToRevenue, enterpriseToEbitda*

- Axe 2 : *totalRevenue, totalCash, grossMargins, ebitdaMargins*

- Axe 3 : *totalEsg, socialScore, ebitdaMargins*

- Axe 4 : *currentRatio, quickRatio*

- Axe 5 : *trailingAnnualDividendYield, trailingAnnualDividendRate*




Avec une telle quantité de données et un grand nombre d’axes, la visualisation des résultats devient complexe. Pour mieux comprendre les structures sous-jacentes, nous allons donc réaliser une ACP ciblée sur les données **ESG**. Cette approche nous permettra d'identifier les principaux facteurs qui influencent spécifiquement les critères environnementaux, sociaux et de gouvernance.





### ACP sur les données ESG

```{r, echo=FALSE}
#ACP sur l'esg
data_esg <- cleaned_data[, c("totalEsg", "environmentScore", "socialScore", "governanceScore","esgPerformance","sector")]

res_pca_esg <- PCA(data_esg, graph = T,scale.unit = TRUE, ncp = 5, quali.sup = c(5,6))
res_pca_esg$eig
plot(res_pca_esg, habillage = 5, select = "cos2 0.8",choix = c("ind"))
plot(res_pca_esg, habillage = 6, select = "cos2 0.95",choix = c("ind"))

```