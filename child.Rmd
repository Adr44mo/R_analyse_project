---
title: "test"
author: "moi"
date: "2025-04-02"
output: html_document
---

---
title: "Projet"
author: "moi"
date: "2025-02-28"
output: html_document
keep_md: true
---

```{r, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
#rmarkdown::render("Projet.Rmd", output_format = "pdf_document")
#rmarkdown::render("Projet.Rmd", output_format = "html_document")
```



# Classification non supervis√©e

üìå 1. Pr√©paration des donn√©es On pr√©pare les donn√©es en supprimant les variables inutiles et en s‚Äôassurant que les variables qualitatives sont bien en facteur.

```{r}
library(FactoMineR)
library(cluster)

# Charger les donn√©es nettoy√©es
data <- cleaned_data

# Suppression des colonnes non utiles (nom, symbole, index, etc.)
data <- data %>% select(-c(Continent))

# Convertir les variables qualitatives en facteur
data$sector <- as.factor(data$sector)
data$country <- as.factor(data$country)
data$esgPerformance <- as.factor(data$esgPerformance)

# V√©rification des NA et nettoyage
data <- na.omit(data)
```

üìå 2. Analyse Factorielle des Donn√©es Mixtes (FAMD) On utilise FAMD (Analyse Factorielle des Donn√©es Mixtes) pour g√©rer variables quantitatives et qualitatives.

```{r}
# FAMD sur les donn√©es
res_famd <- FAMD(data, graph = TRUE, ncp = 5)
```

```{r}
# Cercle des corr√©lations
plot(res_famd, choix = "quanti")

# Graphique des individus
plot(res_famd, choix = "ind")

# changer les dimensions
plot(res_famd, choix = "ind", axes = c(1,3),cos2 = 0.8)
```

üìå 3. Clustering avec k-means sur les premi√®res composantes On applique k-means pour regrouper les entreprises.

```{r}
# Afficher la variance expliqu√©e par dimension
print(res_famd$eig)

# Calculer la variance cumul√©e
variance_cumulee <- cumsum(res_famd$eig[, 2])
print(variance_cumulee)

```

```{r}
# S√©lection des 5 premi√®res dimensions
coord <- res_famd$ind$coord[, 1:5]

# Choix du nombre de clusters (m√©thode de l'inertie)
inertie.intra <- rep(0, 10)
for (k in 1:20) {
  kmeans_res <- kmeans(coord, centers = k, nstart = 100)
  inertie.intra[k] <- kmeans_res$tot.withinss / kmeans_res$totss
}

# Affichage du graphique pour choisir le bon nombre de clusters
plot(1:20, inertie.intra, type = "b", xlab = "Nb. de groupes", ylab = "% inertie intra")

# On choisit 3 groupes ici (√† ajuster selon le graphique)
kmeans_result <- kmeans(coord, centers = 3, nstart = 100)

# Ajout des clusters aux donn√©es
data_cluster <- cbind.data.frame(data, cluster = factor(kmeans_result$cluster))

# observer les clusters
table(data_cluster$cluster)


```

üìå 4. Classification Hi√©rarchique (CAH) avec HCPC On applique la Classification Ascendante Hi√©rarchique (CAH) pour v√©rifier si les groupes sont coh√©rents.

```{r}
# Lancer la CAH sur les r√©sultats de FAMD
cah_res <- HCPC(res_famd, nb.clust = -1, graph = TRUE)
```

üìå 5. Interpr√©tation des clusters On analyse les groupes obtenus.

```{r}
table(data_cluster$cluster)

# Moyennes des variables par cluster
aggregate(data_cluster, by = list(data_cluster$cluster), FUN = mean)


```

```{r}

# Contribution des variables aux axes, du plus au moins impactant
# Boucle sur toutes les dimensions
for (i in 1:ncol(res_famd$var$contrib)) {
  cat("\nDimension", i, ":\n")
  
  # Trier les contributions des variables pour la dimension i
  contributions <- sort(res_famd$var$contrib[, i], decreasing = TRUE)
  
  # Afficher les 5 premi√®res variables les plus influentes
  print(head(contributions, 5))
}


```

üîπ Interpr√©tation des dimensions 

1.Dimension 1 (Axe principal - Facteurs financiers)

- Regroupe des variables √©conomiques et financi√®res cl√©s (revenus, dividendes, valeur comptable).

- Repr√©sente la solidit√© financi√®re et la performance √©conomique d‚Äôune entreprise.

- Une forte valeur sur cet axe indique une entreprise avec une capitalisation boursi√®re √©lev√©e et de bons r√©sultats financiers.

2.Dimension 2 (Facteurs ESG et environnementaux)

- Met en avant les scores ESG (Environnement, Social, Gouvernance) et le secteur d'activit√©.

- Repr√©sente l'engagement des entreprises envers les pratiques durables et responsables.

- Une entreprise avec un score √©lev√© ici est bien not√©e sur les crit√®res ESG et est dans un secteur o√π ces aspects sont valoris√©s.

3.Dimension 3 (Marge et rentabilit√© sectorielle)

- Regroupe des indicateurs de rentabilit√© comme l'EBITDA, les marges op√©rationnelles et le secteur.

- Indique la capacit√© d‚Äôune entreprise √† g√©n√©rer des profits par rapport √† son secteur.

- Une valeur √©lev√©e ici correspond √† une entreprise tr√®s rentable dans son industrie.

4.Dimension 4 (Retour sur actifs et rendement des investissements)

- Focalise sur le retour sur actifs (ROA), le rendement sur investissements et l‚Äôappartenance √† un groupe sectoriel.

- Met en √©vidence les entreprises qui utilisent efficacement leurs ressources pour g√©n√©rer des profits.

- Une valeur forte ici sugg√®re une excellente gestion des actifs et un bon retour sur investissement.

5.Dimension 5 (Sant√© financi√®re et liquidit√©)

- Associe le secteur, la liquidit√© (current ratio, quick ratio) et le pays.

- Capture la capacit√© d‚Äôune entreprise √† faire face √† ses obligations financi√®res √† court terme.

- Une valeur √©lev√©e indique une entreprise avec une bonne gestion de sa tr√©sorerie et un faible risque de liquidit√©.

# Annexe : Explication des variables du jeu de donn√©es

Ce jeu de donn√©es contient des informations sur les principales entreprises mondiales en termes de capitalisation boursi√®re, incluant des indicateurs financiers, des ratios de performance et des scores ESG.

## Variables du jeu de donn√©es

### Informations g√©n√©rales

-   **Rank** : Classement de l'entreprise selon sa capitalisation boursi√®re.
-   **Name** : Nom de l'entreprise.
-   **Symbol** : Symbole boursier de l'entreprise.
-   **country** : Pays d'origine de l'entreprise.
-   **sector** : Secteur d'activit√© (ex : Technologie, Finance, Sant√©, etc.).
-   **Index** : Indice boursier auquel appartient l'entreprise (ex : S&P 500, Nasdaq).
-   **Continent** : Continent d'implantation de l'entreprise.

### Donn√©es de March√©

-   **marketCap** : Capitalisation boursi√®re totale de l'entreprise.
-   **previousClose** : Prix de cl√¥ture de l'action lors de la derni√®re session.
-   **trailingPE** : Ratio prix/b√©n√©fice bas√© sur les b√©n√©fices pass√©s.
-   **forwardPE** : Ratio prix/b√©n√©fice bas√© sur les b√©n√©fices estim√©s.
-   **priceToBook** : Ratio Prix/Valeur comptable.
-   **beta** : Mesure de la volatilit√© du titre par rapport au march√©.

### Performance Financi√®re

-   **profitMargins** : Marge b√©n√©ficiaire nette.
-   **enterpriseToRevenue** : Ratio Valeur d'Entreprise/Chiffre d'Affaires.
-   **enterpriseToEbitda** : Ratio Valeur d'Entreprise/EBITDA.
-   **totalRevenue** : Chiffre d'affaires total.
-   **revenuePerShare** : Chiffre d'affaires par action.
-   **revenueGrowth** : Croissance du chiffre d'affaires.
-   **grossMargins** : Marge brute.
-   **ebitdaMargins** : Marge EBITDA.
-   **operatingMargins** : Marge op√©rationnelle.

### Rentabilit√© et Gestion Financi√®re

-   **returnOnAssets (ROA)** : Rentabilit√© des actifs.
-   **returnOnEquity (ROE)** : Rentabilit√© des fonds propres.
-   **debtToEquity** : Ratio d'endettement.
-   **currentRatio** : Ratio de liquidit√© courante.
-   **quickRatio** : Ratio de liquidit√© imm√©diate.
-   **totalCash** : Montant total des liquidit√©s.
-   **totalDebt** : Montant total des dettes.
-   **bookValue** : Valeur comptable de l'entreprise.

### Dividendes et Rendement Actionnarial

-   **fiveYearAvgDividendYield** : Rendement moyen des dividendes sur 5 ans.
-   **payoutRatio** : Pourcentage des b√©n√©fices distribu√©s en dividendes.
-   **trailingAnnualDividendYield** : Rendement annuel des dividendes.
-   **trailingAnnualDividendRate** : Montant du dividende annuel par action.

### Donn√©es ESG (Environnement, Social, Gouvernance)

-   **totalEsg** : Score ESG total.
-   **environmentScore** : Score environnemental.
-   **socialScore** : Score social.
-   **governanceScore** : Score de gouvernance.
-   **ratingYear** : Ann√©e de notation ESG.
-   **ratingMonth** : Mois de notation ESG.
-   **highestControversy** : Niveau de controverse maximal associ√© √† l'entreprise.
-   **peerCount** : Nombre d'entreprises comparables pour l'√©valuation ESG.
-   **esgPerformance** : Cat√©gorie de performance ESG (ex : LEAD_PERF, AVG_PERF, LAG_PERF).
-   **peerGroup** : Groupe de comparaison sectoriel pour l'ESG.

------------------------------------------------------------------------
