---
title: "AFC"
author: "moi"
date: "2025-04-03"
output: html_document
---

```{r}
# ðŸŸ¢ 2. CrÃ©er le tableau de contingence entre `sector` et `esgPerformance`
contingence_table <- table(cleaned_data$sector, cleaned_data$esgPerformance)

print(contingence_table)

# ðŸŸ¢ 3. Effectuer l'AFC
afc_result <- CA(contingence_table, graph = TRUE)

# ðŸŸ¢ 4. Visualiser les rÃ©sultats avec un biplot
fviz_ca_biplot(afc_result, repel = TRUE)

```

Explications des rÃ©sultats de l'AFC:

```{r}
# ðŸŸ¢ 6. Visualiser les contributions des modalitÃ©s
fviz_ca_row(afc_result, col.row = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), repel = TRUE) +
  labs(title = "Contributions des modalitÃ©s aux axes de l'AFC") +
  theme_minimal()

# ðŸŸ¢ 7. Visualiser les contributions des variables
fviz_ca_col(afc_result, col.col = "cos2", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), repel = TRUE) +
  labs(title = "Contributions des variables aux axes de l'AFC") +
  theme_minimal()

```
```{r}
Techology <- round(contingence_table["Technology",] / sum(contingence_table["Technology",]), 2)
Energy <- round(contingence_table["Energy",] / sum(contingence_table["Energy",]), 2)
Financial <- round(contingence_table["Financial Services",] / sum(contingence_table["Financial Services",]), 2)

# 6. Calcul du profil moyen
moyen <- round(apply(contingence_table, 2, sum) / sum(apply(contingence_table, 2, sum)), 2)

# 7. CrÃ©er une matrice contenant tous les profils
M <- rbind(Techology, Energy, Financial, moyen = moyen)

# ðŸŸ¢ 8. Afficher la matrice des profils
print(M)

# ðŸŸ¢ 9. Visualisation en barplot
barplot(t(M), xlim = c(0, ncol(t(M)) + 3), col = 1:12, legend.text = colnames(contingence_table),
        args.legend = list(x = "topright"))
```


